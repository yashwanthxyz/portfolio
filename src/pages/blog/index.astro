---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import PostRow from "../../components/Blog/PostRow.astro";

const posts = (await getCollection("blog"))?.sort((a, b) => {
  const pubDateDiff = (b.data.pubDate || new Date()).getTime() - (a.data.pubDate || new Date()).getTime();
  if (pubDateDiff === 0) {
    return (b.data.createdAt || new Date()).getTime() - (a.data.createdAt || new Date()).getTime();
  }
  return pubDateDiff;
});
---

<script>
  import { animate, type AnimationSequence } from "motion";
  import { loaderAnimation } from "../../lib/constants";

  const sequence = [loaderAnimation];
  animate(sequence as AnimationSequence);
</script>

<Layout
  description="A collection of articles and thoughts about technology, programming, and more"
  title="Yashwanth - Blog"
>
  <main class="w-screen min-h-screen bg-neutral-950">
    <div class="max-w-3xl mx-auto px-6 py-16">
      <nav class="mb-12">
        <a
          class="inline-flex items-center gap-2 text-neutral-400 hover:text-white transition-colors"
          href="/"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back
        </a>
      </nav>

      <header class="mb-12">
        <h1 class="text-4xl font-bold mb-4 text-white">Blog</h1>
      </header>

      <ul class="space-y-1">
        {
          posts?.map((post) => (
            <PostRow
              date={post.data.pubDate || new Date()}
              id={post.id}
              title={post.data.title || "No title"}
            />
          ))
        }
      </ul>
    </div>
  </main>
</Layout>
